statement ok
create table lineitem (
        l_orderkey BIGINT,
        l_partkey INTEGER,
        l_suppkey INTEGER,
        l_linenumber INTEGER,
        l_quantity NUMERIC,
        l_extendedprice NUMERIC,
        l_discount NUMERIC,
        l_tax NUMERIC,
        l_returnflag CHAR(1),
        l_linestatus CHAR(1),
        l_shipdate DATE,
        l_commitdate DATE,
        l_receiptdate DATE,
        l_shipinstruct CHAR(25),
        l_shipmode CHAR(10),
        l_comment VARCHAR(44));


statement ok
create materialized view tpch_q6 as
select
	sum(l_extendedprice * l_discount) as revenue
from
	lineitem
where
	l_shipdate >= date '1994-01-01'
	and l_shipdate < date '1994-01-01' + interval '1' year
	and l_discount between 0.08 - 0.01 and 0.08 + 0.01
	and l_quantity < 24;

statement ok
insert into lineitem values
(1,1,1,1,23,1,0.08,1,'1','1','1994-02-01'::DATE,'1994-02-01'::DATE,'1994-02-01'::DATE,'1','1','1'),
(1,1,1,1,23,1,0.085,1,'1','1','1994-01-14'::DATE,'1994-02-01'::DATE,'1994-02-01'::DATE,'1','1','1'),
(3,1,1,1,25,1,0.075,1,'1','1','1994-01-21'::DATE,'1994-02-01'::DATE,'1994-02-01'::DATE,'1','1','1'),
(3,1,1,1,22,1,0.081,1,'1','1','1996-08-26'::DATE,'1994-02-01'::DATE,'1994-02-01'::DATE,'1','1','1');

sleep 1s

query R
select * from tpch_q6;
----
0.165
