statement ok
create table t1 (v1 int not null, v2 int not null, v3 int not null);

statement ok
create table t2 (v1 int not null, v2 int not null, v3 int not null);

statement ok
create table t3 (v1 int not null, v2 int not null, v3 int not null);

statement ok
insert into t1 values (1,4,2), (2,3,3);

statement ok
insert into t3 values (1,3,5), (2,4,6);

statement ok
create materialized view mv1 as select * from t1 join t3 on t1.v2 = t3.v2 order by t1.v1 DESC;

statement ok
create materialized view mv2 as select * from t1 order by t1.v2 DESC, t1.v3 ASC;

statement ok
create materialized view mv3 as select * from t1 order by t1.v2 DESC, t1.v3 ASC limit 2 offset 1;

sleep 1s

query IIIIIIII
select * from mv1;
----
2 3 3 1 1 3 5 0
1 4 2 0 2 4 6 1

statement ok
insert into t1 values (3,4,4), (4,3,5);

sleep 1s

query IIIIIIII
select * from mv1;
----
4 3 5 3 1 3 5 0
3 4 4 2 2 4 6 1
2 3 3 1 1 3 5 0
1 4 2 0 2 4 6 1

query IIII
select * from mv2;
----
1 4 2 0
3 4 4 2
2 3 3 1
4 3 5 3

query IIII
select * from mv3;
----
3 4 4 2
2 3 3 1

statement ok
drop table t1

statement ok
drop table t2

statement ok
drop table t3

statement ok
drop table mv1
