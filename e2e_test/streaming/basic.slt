statement ok
create table t1 (v1 int not null, v2 int not null, v3 int not null);

statement ok
insert into t1 values (1,4,2), (2,3,3);

statement ok
create materialized view mv1 as select * from t1;

statement ok
create materialized view mv2 as select sum(v1) as sum_v1, sum(v2) as sum_v2, sum(v3) as sum_v3 from t1;

query III
select v1, v2, v3 from mv1;
----
1 4 2
2 3 3

query III
select sum_v1, sum_v2, sum_v3 from mv2;
----
3 7 5

statement ok
insert into t1 values (3,4,4), (4,3,5);

sleep 1s

query III
select v1, v2, v3 from mv1
----
1 4 2
2 3 3
3 4 4
4 3 5

query III
select sum_v1, sum_v2, sum_v3 from mv2;
----
10 14 14
