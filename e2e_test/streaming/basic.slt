statement ok
create table t1 (v1 int not null, v2 int not null, v3 int not null);

statement ok
create table t2 (v1 int not null, v2 int not null, v3 int not null);

statement ok
create table t3 (v1 int not null, v2 int not null, v3 int not null);

statement ok
insert into t1 values (1,4,2), (2,3,3);

statement ok
insert into t3 values (1,3,5), (2,4,6);

statement ok
create materialized view mv1 as select * from t1;

statement ok
create materialized view mv2 as select sum(v1) as sum_v1, sum(v2) as sum_v2, count(v3) as count_v3 from t1;

statement ok
create materialized view mv3 as select * from t1 INNER JOIN t3 ON t1.v1=t3.v1;

query III
select v1, v2, v3 from mv1;
----
1 4 2
2 3 3

query III
select sum_v1, sum_v2, count_v3 from mv2;
----
3 7 2

query IIIIIIII
select * from mv3;
----
1 4 2 0 1 3 5 0
2 3 3 1 2 4 6 1

statement ok
insert into t1 values (3,4,4), (4,3,5);

sleep 1s

query III
select v1, v2, v3 from mv1;
----
1 4 2
2 3 3
3 4 4
4 3 5

query III
select sum_v1, sum_v2, count_v3 from mv2;
----
10 14 4
