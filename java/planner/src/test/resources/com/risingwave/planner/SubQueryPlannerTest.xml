<Root>
    <TestCase name="tpch q2">
        <Resource name="sql">
            <![CDATA[
select
	s_acctbal,
	s_name,
	n_name,
	p_partkey,
	p_mfgr,
	s_address,
	s_phone,
	s_comment
from
	part,
	supplier,
	partsupp,
	nation,
	region
where
	p_partkey = ps_partkey
	and s_suppkey = ps_suppkey
	and p_size = 38
	and p_type like '%TIN'
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'MIDDLE EAST'
	and ps_supplycost = (
		select
			min(ps_supplycost)
		from
			partsupp,
			supplier,
			nation,
			region
		where
			p_partkey = ps_partkey
			and s_suppkey = ps_suppkey
			and s_nationkey = n_nationkey
			and n_regionkey = r_regionkey
			and r_name = 'MIDDLE EAST'
	)
order by
	s_acctbal desc,
	n_name,
	s_name,
	p_partkey
LIMIT 100;
            ]]>
        </Resource>
        <Resource name="distributed">
            <![CDATA[
RwBatchSort(sort0=[$0], sort1=[$2], sort2=[$1], sort3=[$3], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC], fetch=[100])
  RwBatchSort(sort0=[$0], sort1=[$2], sort2=[$1], sort3=[$3], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC], fetch=[100])
    RwBatchExchange(distribution=[RwDistributionTrait{type=SINGLETON, keys=[]}], collation=[[]])
      RwBatchProject(s_acctbal=[$21], s_name=[$17], n_name=[$24], p_partkey=[$2], p_mfgr=[$4], s_address=[$18], s_phone=[$20], s_comment=[$22])
        RwBatchHashJoin(condition=[=($25, $27)], joinType=[inner])
          RwBatchExchange(distribution=[RwDistributionTrait{type=HASH_DISTRIBUTED, keys=[25]}], collation=[[]])
            RwBatchHashJoin(condition=[=($19, $23)], joinType=[inner])
              RwBatchExchange(distribution=[RwDistributionTrait{type=HASH_DISTRIBUTED, keys=[19]}], collation=[[]])
                RwBatchHashJoin(condition=[=($16, $12)], joinType=[inner])
                  RwBatchExchange(distribution=[RwDistributionTrait{type=HASH_DISTRIBUTED, keys=[12]}], collation=[[]])
                    RwBatchHashJoin(condition=[AND(=($14, $1), =($2, $11))], joinType=[inner])
                      RwBatchExchange(distribution=[RwDistributionTrait{type=HASH_DISTRIBUTED, keys=[1, 2]}], collation=[[]])
                        RwBatchHashJoin(condition=[=($2, $0)], joinType=[inner])
                          RwBatchHashAgg(group=[{0}], EXPR$0=[MIN($1)])
                            RwBatchExchange(distribution=[RwDistributionTrait{type=HASH_DISTRIBUTED, keys=[0]}], collation=[[]])
                              RwBatchHashAgg(group=[{0}], EXPR$0=[MIN($1)])
                                RwBatchProject(ps_partkey=[$7], ps_supplycost=[$10])
                                  RwBatchHashJoin(condition=[=($14, $16)], joinType=[inner])
                                    RwBatchExchange(distribution=[RwDistributionTrait{type=HASH_DISTRIBUTED, keys=[14]}], collation=[[]])
                                      RwBatchHashJoin(condition=[=($3, $12)], joinType=[inner])
                                        RwBatchExchange(distribution=[RwDistributionTrait{type=HASH_DISTRIBUTED, keys=[3]}], collation=[[]])
                                          RwBatchHashJoin(condition=[=($0, $8)], joinType=[inner])
                                            RwBatchExchange(distribution=[RwDistributionTrait{type=HASH_DISTRIBUTED, keys=[0]}], collation=[[]])
                                              RwBatchTableScan(table=[[test_schema, supplier]], columns=[s_suppkey,s_name,s_address,s_nationkey,s_phone,s_acctbal,s_comment])
                                            RwBatchExchange(distribution=[RwDistributionTrait{type=HASH_DISTRIBUTED, keys=[1]}], collation=[[]])
                                              RwBatchFilter(condition=[IS NOT NULL($0)])
                                                RwBatchTableScan(table=[[test_schema, partsupp]], columns=[ps_partkey,ps_suppkey,ps_availqty,ps_supplycost,ps_comment])
                                        RwBatchExchange(distribution=[RwDistributionTrait{type=HASH_DISTRIBUTED, keys=[0]}], collation=[[]])
                                          RwBatchTableScan(table=[[test_schema, nation]], columns=[n_nationkey,n_name,n_regionkey,n_comment])
                                    RwBatchExchange(distribution=[RwDistributionTrait{type=HASH_DISTRIBUTED, keys=[0]}], collation=[[]])
                                      RwBatchFilter(condition=[=($1, 'MIDDLE EAST':CHAR(11))])
                                        RwBatchTableScan(table=[[test_schema, region]], columns=[r_regionkey,r_name,r_comment])
                          RwBatchExchange(distribution=[RwDistributionTrait{type=HASH_DISTRIBUTED, keys=[0]}], collation=[[]])
                            RwBatchFilter(condition=[AND(=($5, 38), LIKE($4, '%TIN':CHAR(4)), IS NOT NULL($0))])
                              RwBatchTableScan(table=[[test_schema, part]], columns=[p_partkey,p_name,p_mfgr,p_brand,p_type,p_size,p_container,p_retailprice,p_comment])
                      RwBatchExchange(distribution=[RwDistributionTrait{type=HASH_DISTRIBUTED, keys=[0, 3]}], collation=[[]])
                        RwBatchFilter(condition=[IS NOT NULL($0)])
                          RwBatchTableScan(table=[[test_schema, partsupp]], columns=[ps_partkey,ps_suppkey,ps_availqty,ps_supplycost,ps_comment])
                  RwBatchExchange(distribution=[RwDistributionTrait{type=HASH_DISTRIBUTED, keys=[0]}], collation=[[]])
                    RwBatchTableScan(table=[[test_schema, supplier]], columns=[s_suppkey,s_name,s_address,s_nationkey,s_phone,s_acctbal,s_comment])
              RwBatchExchange(distribution=[RwDistributionTrait{type=HASH_DISTRIBUTED, keys=[0]}], collation=[[]])
                RwBatchTableScan(table=[[test_schema, nation]], columns=[n_nationkey,n_name,n_regionkey,n_comment])
          RwBatchExchange(distribution=[RwDistributionTrait{type=HASH_DISTRIBUTED, keys=[0]}], collation=[[]])
            RwBatchFilter(condition=[=($1, 'MIDDLE EAST':CHAR(11))])
              RwBatchTableScan(table=[[test_schema, region]], columns=[r_regionkey,r_name,r_comment])
            ]]>
        </Resource>
    </TestCase>
</Root>
