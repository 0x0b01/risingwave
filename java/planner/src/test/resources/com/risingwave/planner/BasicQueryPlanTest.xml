<Root>
    <TestCase name="select all columns from table">
        <Resource name="sql">
            <![CDATA[
select * from t
            ]]>
        </Resource>
        <Resource name="plan">
            <![CDATA[
BatchFilterScan(table=[[test_schema, t]], columns=[v1,v2,v3])
            ]]>
        </Resource>
        <Resource name="json">
            <![CDATA[
{
  "nodeType": "FILTER_SCAN",
  "body": {
    "@type": "type.googleapis.com/risingwave.executor.proto.FilterScanNode",
    "tableRefId": {
      "schemaRefId": {
        "databaseRefId": {
        }
      },
      "tableId": 1
    },
    "columnIds": [1, 2, 3]
  }
}
            ]]>
        </Resource>
    </TestCase>
    <TestCase name="insert into values">
        <Resource name="sql">
            <![CDATA[
insert into t values(1,4,2), (2,3,3), (3,4,4), (4,3,5)
            ]]>
        </Resource>
        <Resource name="plan">
            <![CDATA[
BatchInsertValues(table=[t], values=[((1,4,2:FLOAT),(2,3,3:FLOAT),(3,4,4:FLOAT),(4,3,5:FLOAT))])
]]>
        </Resource>
        <Resource name="json">
            dafads
        </Resource>
    </TestCase>

    <TestCase name="select with filter">
        <Resource name="sql">
            <![CDATA[
select * from t where v1 > 1
            ]]>
        </Resource>
        <Resource name="plan">
            <![CDATA[
BatchProject(v1=[$0], v2=[$1], v3=[$2])
  BatchFilter(condition=[>($0, 1)])
    BatchFilterScan(table=[[test_schema, t]], columns=[v1,v2,v3])
            ]]>
        </Resource>
        <Resource name="json">
            fdsa
        </Resource>
    </TestCase>

    <TestCase name="select with non-key sum 1">
        <Resource name="sql">
            <![CDATA[
select sum(v1+v2),sum(v1+v3) from t
            ]]>
        </Resource>
        <Resource name="plan">
            <![CDATA[
BatchHashAgg(group=[{}], EXPR$0=[SUM($0)], EXPR$1=[SUM($1)])
  BatchProject($f0=[+($0, $1)], $f1=[+($0, $2)])
    BatchFilterScan(table=[[test_schema, t]], columns=[v1,v2,v3])            ]]>
        </Resource>
        <Resource name="json">
            fas
        </Resource>
    </TestCase>

    <TestCase name="select with non-key sum 2">
        <Resource name="sql">
            <![CDATA[
select sum(v1), sum(v3) from t
            ]]>
        </Resource>
        <Resource name="plan">
            <![CDATA[
BatchHashAgg(group=[{}], EXPR$0=[SUM($0)], EXPR$1=[SUM($1)])
  BatchFilterScan(table=[[test_schema, t]], columns=[v1,v3])
]]>
        </Resource>
        <Resource name="json">
            fda
        </Resource>
    </TestCase>

    <TestCase name="select with non-key min">
        <Resource name="sql">
            <![CDATA[
select min(v1) from t
            ]]>
        </Resource>
        <Resource name="plan">
            <![CDATA[
BatchHashAgg(group=[{}], EXPR$0=[MIN($0)])
  BatchFilterScan(table=[[test_schema, t]], columns=[v1])
]]>
        </Resource>
        <Resource name="json">
            fda
        </Resource>
    </TestCase>

    <TestCase name="select with non-key max">
        <Resource name="sql">
            <![CDATA[
select max(v1) from t
            ]]>
        </Resource>
        <Resource name="plan">
            <![CDATA[
BatchHashAgg(group=[{}], EXPR$0=[MAX($0)])
  BatchFilterScan(table=[[test_schema, t]], columns=[v1])
]]>
        </Resource>
        <Resource name="json">
            dfas
        </Resource>
    </TestCase>

    <TestCase name="select with non-key max with filter">
        <Resource name="sql">
            <![CDATA[
select max(v1) from t where v2>3
    ]]>
        </Resource>
        <Resource name="plan">
            <![CDATA[
BatchHashAgg(group=[{}], EXPR$0=[MAX($0)])
  BatchProject(v1=[$0])
    BatchFilter(condition=[>($1, 3)])
      BatchFilterScan(table=[[test_schema, t]], columns=[v1,v2])
            ]]>
        </Resource>
        <Resource name="json">
            fdas
        </Resource>
    </TestCase>

    <TestCase name="select with non-key avg">
        <Resource name="sql">
            <![CDATA[
select avg(v2) from t
            ]]>
        </Resource>
        <Resource name="plan">
            <![CDATA[
BatchHashAgg(group=[{}], EXPR$0=[AVG($0)])
  BatchFilterScan(table=[[test_schema, t]], columns=[v2])
]]>
        </Resource>
        <Resource name="json">
            fdsa
        </Resource>
    </TestCase>

    <TestCase name="select with sum and group by">
        <Resource name="sql">
            <![CDATA[
select sum(v1), v2 from t group by v2
            ]]>
        </Resource>
        <Resource name="plan">
            <![CDATA[
BatchProject(EXPR$0=[$1], v2=[$0])
  BatchHashAgg(group=[{0}], EXPR$0=[SUM($1)])
    BatchFilterScan(table=[[test_schema, t]], columns=[v2,v1])
]]>
        </Resource>
        <Resource name="json">
            fdsa
        </Resource>
    </TestCase>
    <TestCase name="select with sum and group by">
        <Resource name="sql">
            <![CDATA[
select 100.0::DOUBLE/8.0::DOUBLE
]]>
        </Resource>
        <Resource name="plan">
            <![CDATA[
BatchProject(EXPR$0=[/(1.000E2:DOUBLE, 8.0E0:DOUBLE)])
  BatchValues(tuples=[[{ 0 }]])
]]>
        </Resource>
        <Resource name="json">
            fdsa
        </Resource>
    </TestCase>
</Root>