<Root>
    <TestCase name="query 1">
        <Resource name="sql">
            <![CDATA[
create materialized view T1 as select sum(v2) as V from t where v1>1
            ]]>
        </Resource>
        <Resource name="plan">
            <![CDATA[
RwStreamMaterializedView(name=[t1])
  RwStreamProject(v=[$STREAM_NULL_BY_ROW_COUNT($0, $1)], $f0=[$0], v_copy=[$1])
    RwStreamAgg(group=[{}], agg#0=[COUNT()], v=[SUM($1)])
      RwStreamFilter(condition=[>($0, 1)])
        RwStreamTableSource(table=[[test_schema, t]], columns=[v1,v2,_row_id])
]]>
        </Resource>
        <Resource name="json" path="streaming/materialized_view_on_materialized_view_plan_test/q1">
        </Resource>>
        <Resource name="primaryKey">
            <![CDATA[
[1, 2]
            ]]>
        </Resource>
    </TestCase>

    <TestCase name="query 2">
        <Resource name="sql">
            <![CDATA[
create materialized view T2 as select sum(T1.V)+1 as VoV from T1
            ]]>
        </Resource>
        <Resource name="plan">
            <![CDATA[
RwStreamMaterializedView(name=[t2])
  RwStreamProject(vov=[+($STREAM_NULL_BY_ROW_COUNT($0, $1), 1)], $f0=[$0], $f1=[$1])
    RwStreamAgg(group=[{}], agg#0=[COUNT()], agg#1=[SUM($0)])
      RwStreamChain(firstTableRefId=[0.0.1])
        RwStreamBroadcast
          RwStreamMaterializedViewSource(table=[[test_schema, t1]], columns=[v])
]]>
        </Resource>
        <Resource name="json" path="streaming/materialized_view_on_materialized_view_plan_test/q2">
        </Resource>>
        <Resource name="primaryKey">
            <![CDATA[
[1, 2]
            ]]>
        </Resource>
    </TestCase>
</Root>
