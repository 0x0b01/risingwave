<Root>
    <TestCase name="query 1 hash join">
        <Resource name="sql">
            <![CDATA[
create materialized view mv1 as select * from t, t3 where t.v2 = t3.v1;
            ]]>
        </Resource>
        <Resource name="plan">
            <![CDATA[
RwStreamMaterializedView(name=[mv1])
  RwStreamHashJoin(condition=[=($1, $4)], joinType=[inner])
    RwStreamExchange(distribution=[RwDistributionTrait{type=HASH_DISTRIBUTED, keys=[1]}], collation=[[]])
      RwStreamTableSource(table=[[test_schema, t]], columns=[v1,v2,v3,_row_id])
    RwStreamExchange(distribution=[RwDistributionTrait{type=HASH_DISTRIBUTED, keys=[0]}], collation=[[]])
      RwStreamTableSource(table=[[test_schema, t3]], columns=[v1,_row_id])
]]>
        </Resource>
        <Resource name="primaryKey">
            <![CDATA[
[3, 5]
]]>
        </Resource>
    </TestCase>
    <TestCase name="query 1 hash join">
        <Resource name="sql">
            <![CDATA[
create materialized view mv2 as select * from t, t3 where t.v2 = t3.v1 and t.v1 > t3.v1;
            ]]>
        </Resource>
        <Resource name="plan">
            <![CDATA[
RwStreamMaterializedView(name=[mv2])
  RwStreamHashJoin(condition=[AND(=($1, $4), >($0, $4))], joinType=[inner])
    RwStreamExchange(distribution=[RwDistributionTrait{type=HASH_DISTRIBUTED, keys=[1]}], collation=[[]])
      RwStreamTableSource(table=[[test_schema, t]], columns=[v1,v2,v3,_row_id])
    RwStreamExchange(distribution=[RwDistributionTrait{type=HASH_DISTRIBUTED, keys=[0]}], collation=[[]])
      RwStreamTableSource(table=[[test_schema, t3]], columns=[v1,_row_id])
]]>
        </Resource>
        <Resource name="primaryKey">
            <![CDATA[
[3, 5]
]]>
        </Resource>
    </TestCase>
</Root>
